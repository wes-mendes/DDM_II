/*! zaz-app-t360-horoscope - v1.0.0 - 19/12/2024 -- 5:41pm */

zaz.use(function(pkg){"use strict";var console=pkg.console,dictFactory;pkg.factoryManager.get("dict").create({name:"t360.horoscope",version:"2.0.0",state:"ok",extends:[],langs:{pt:{horoscopo:"HORÓSCOPO",horoscopoDoDia:"Horóscopo do dia ",naoEOSeuSigno:"não é o seu <b>signo?</b>",trocarSigno:"Trocar signo",confiraHoroscopoDoDia:"Confira o Horóscopo do dia "},en:{},es:{},global:{}}})}),zaz.use(function appHoroscope(pkg){"use strict";var console=pkg.console,appFactory,STATIC_PUBLIC=null,STATIC_PRIVATE={};pkg.factoryManager.get("app").create({name:"t360.horoscope",version:"1.0.0",state:"ok",docs:"http://github.tpn.terra.com/pages/terra/zaz-app-horoscope",source:"http://github.tpn.terra.com/Terra/zaz-app-horoscope",description:"Just another app",tests:"http://s1.trrsf.com/fe/zaz-app-horoscope/tests/index.htm?zaz[env]=tests",dependencies:[],dictionaries:["t360.horoscope"],templates:{horoscope:'{% if device == \'mob\' %}{% if not isHome %}{% set classIcon = \'icon-52\' %}{% else %}{% set classIcon = \'icon-32\' %}{% endif %}{% else %}{% set classIcon = \'icon-52\' %}{% endif %}{% if not classIcon %}{% set classIcon = \'icon-52\' %}{% endif %}<div class="app-horoscope__detail"><ul>{% for sign in signs %}<li class="app-horoscope__item item{% if not sign.featured %} close{% endif %}"><div class="app-horoscope__item--container"><div class="app-horoscope__item--container--informative"><div class="app-horoscope__item--container--informative-group"><p class="app-horoscope__item--container--informative--text">Horóscopo de hoje</p><div class="date app-horoscope__item--container--informative--date"><span>{{ date }}</span></div></div><a class="terra-astral" href="https://www.terra.com.br/vida-e-estilo/horoscopo/terra-astral/?utm_source=portal-terra&utm_medium=espaco-fixo&utm_campaign=barra-central&utm_content=pg&utm_term=terra-astral_widget-horoscopo&cdConvenio=CVTR00002055"></a></div><div class="app-horoscope__item--container--header"><div class="app-horoscope__item--container--header--wrapper"><a href="{{ sign.main_page_url }}" title="{{ sign.name }}"><span class="icon-symbol-{{ sign.id }} icon {{ classIcon }}" alt="{{ sign.name }}">{{ sign.name }}</span></a><div class="title">{{ sign.name }}</div></div></div><div class="resume"><a href="{{ sign.main_page_url }}" title="{{ sign.name }}"><div class="app-horoscope__item--container--description">{{ sign.resume }}</div></a></div><a href="{{ sign.main_page_url }}" title="{{ sign.name }}"><button class="app-horoscope__item--continue">Continuar Lendo</button></a><button data-action="open-mosaic" class="app-horoscope__item--change">Trocar Signo</button></div></li>{% endfor %}</ul></div>',mosaic:"{% set horoscope_signs = [{'name': 'aries','label': 'Áries','color': 'aries'},{'name': 'taurus','label': 'Touro','color': 'touro'},{'name': 'gemini','label': 'Gêmeos','color': 'gemeos'},{'name': 'cancer','label': 'Câncer','color': 'cancer'},{'name': 'leo','label': 'Leão','color': 'leao'},{'name': 'virgo','label': 'Virgem','color': 'virgem'},{'name': 'libra','label': 'Libra','color': 'libra'},{'name': 'scorpio','label': 'Escorpião','color': 'escorpiao'},{'name': 'sagittarius','label': 'Sagitário','color': 'sagitario'},{'name': 'capricorn','label': 'Capricórnio','color': 'capricornio'},{'name': 'aquarius','label': 'Aquário','color': 'aquario'},{'name': 'pisces','label': 'Peixes','color': 'peixes'}] %}{% set mosaic_list_prestyle = '' %}{% set mosaic_list_item_prestyle = '' %}{% if context['device'] == 'mob' %}{% set mosaic_list_prestyle = 'display:flex;flex-wrap:wrap' %}{% set mosaic_list_item_prestyle = 'width:25%;height:71px;display:flex;flex-direction:column;align-items:center;margin-bottom:10px' %}{% endif %}<div class=\"app-horoscope__mosaic show\"><header class=\"app-horoscope__mosaic--header\"><div class=\"app-horoscope__mosaic--header__group\"><span class=\"app-horoscope__mosaic--header__title\">Horóscopo</span><span class=\"app-horoscope__mosaic--header__label\">Selecione seu signo</span></div><a class=\"terra-astral\" href=\"https://www.terra.com.br/vida-e-estilo/horoscopo/terra-astral/?utm_source=portal-terra&utm_medium=espaco-fixo&utm_campaign=barra-central&utm_content=pg&utm_term=terra-astral_widget-horoscopo&cdConvenio=CVTR00002055\"></a></header><ul class=\"app-horoscope__mosaic--list\" style=\"{{ mosaic_list_prestyle }}\">{% for sign in horoscope_signs %}<li class=\"app-horoscope__mosaic--list__item\" style=\"{{ mosaic_list_item_prestyle }}\"><button class=\"app-horoscope__mosaic--list__item-wrapper bg-color-secondary-{{ sign.color }}\" data-action=\"open-sign\" data-action-param=\"{{ sign.name }}\" alt=\"Capricórnio\"><div title=\"{{ sign.label }}\" class=\"icon-24 bg-color-{{ sign.color }} icon-solid icon-{{ sign.name }}\">{{ sign.label }}</div></button><span class=\"app-horoscope__mosaic--list__item__text\">{{ sign.label }}</span></li>{% endfor %}</ul></div>"},expects:{type:"object",required:!0,properties:{container:{type:"object",required:!0},data:{type:"object",required:!1}}},setup:function(STATIC_PUBLIC,PUBLIC,__shared){var PRIVATE={}},init:function(data,__shared){var PUBLIC=this,PRIVATE={container:data.container,list:[],changeButtons:null,horoscopo:null,img:null,description:null,items:null,actions:{"open-sign":function(sign){PRIVATE.signs||PRIVATE.container.classList.add("loading-app"),PRIVATE._setUserStoredSign(sign)},"open-mosaic":function(){PRIVATE.showMosaic(),PRIVATE._setUserStoredSign(void 0)}},isBigCard:data.container.classList.contains("card-app-v"),deviceType:window.trr.contextData.device},backendRenderd;return PUBLIC.render=function render(id){var cardsign,vars="card-sign-"+pkg.context.page.get("lang")+"?type=json&country="+(pkg.context.page.get("country")||"br")+"&jsonp=false";PRIVATE.signs?PRIVATE.renderHoroscope(id):fetch("https://www.terra.com.br/feeder/horoscopo/"+vars).then(function(response){return response.json()}).then(function(data){PRIVATE.signs=data.signs_list,PRIVATE.signs.forEach(PRIVATE._arrayDictionary),id&&PRIVATE.renderHoroscope(id),PRIVATE.container.classList.remove("loading-app")})},PRIVATE.renderMosaic=function(data){var tpl=PUBLIC.templates.render("mosaic",{});PRIVATE.container.appendChild(tpl),PRIVATE.container.classList.remove("loading-app"),"mob"===PRIVATE.deviceType&&PRIVATE.removePreStyles(PRIVATE.container)},PRIVATE.renderHoroscope=function renderHoroscope(id){var i,tpl=new Date,tpl=PRIVATE.isBigCard?"Horóscopo diário - "+tpl.getDate()+"/"+PRIVATE.month(tpl.getMonth()+1)+"/"+tpl.getFullYear():tpl.getDate()+"/"+PRIVATE.month(tpl.getMonth()+1),tpl={country:pkg.context.page.getCountry().toLowerCase(),date:tpl,signs:PRIVATE.signs,l10n:PUBLIC.l10n,isHome:pkg.context.page.get("isHome"),device:PRIVATE.deviceType,resume:""};tpl.signs=tpl.signs.filter(function(sign){return sign.id==id});var tpl=PUBLIC.templates.render("horoscope",tpl);PRIVATE.elemDetail&&PRIVATE.container.removeChild(PRIVATE.elemDetail),PRIVATE.container.appendChild(tpl),PRIVATE.elemDetail=PRIVATE.container.querySelector(".app-horoscope__detail"),PRIVATE.showDetail()},PRIVATE.month=function month(d){return d<10?"0"+d.toString():d.toString()},PRIVATE.addEllipsis=function addEllipsis(item){var str=item.innerHTML.substring(0,72).trim()+"...";item.innerHTML=str},PRIVATE.showDetail=function showCard(){PRIVATE.elemDetail.classList.add("show"),PRIVATE.elemMosaic.classList.remove("show")},PRIVATE.showMosaic=function showCard(){PRIVATE.elemDetail.classList.remove("show"),PRIVATE.elemMosaic.classList.add("show")},PRIVATE._setUserStoredSign=function _setUserStoredSign(sign,cb){pkg.context.user.set("horoscope",sign,cb)},PRIVATE._arrayDictionary=function _arrayDictionary(value,index,array){value.id&&isNaN(value.id)&&(array[value.id]=value)},PRIVATE.getAction=function(elem){if(elem!==PRIVATE.container&&elem!==document.body){var action=elem.getAttribute("data-action");return action?{name:action,param:elem.getAttribute("data-action-param")}:PRIVATE.getAction(elem.parentElement)}},PRIVATE.handleClick=function handeClick(action){var action=PRIVATE.getAction(action.target);action&&"function"==typeof PRIVATE.actions[action.name]&&PRIVATE.actions[action.name](action.param)},PRIVATE.removePreStyles=function(container){container&&container.querySelectorAll(".app-horoscope__mosaic--list, .app-horoscope__mosaic--list__item").forEach(function(el){el.style=""})},PRIVATE.container.htmlDataset("loaded")||(PRIVATE.container.classList.add("app-horoscope"),PRIVATE.container.addEventListener("click",PRIVATE.handleClick,!0),"backend"===PRIVATE.container.htmlDataset("renderType")?(PRIVATE.container.classList.remove("loading-app"),"mob"===PRIVATE.deviceType&&PRIVATE.removePreStyles(PRIVATE.container)):PRIVATE.renderMosaic(),PRIVATE.container.htmlDataset("loaded",!0),PRIVATE.elemMosaic=PRIVATE.container.querySelector(".app-horoscope__mosaic"),pkg.context.user.get("horoscope",function(horoscope){horoscope&&PUBLIC.render(horoscope)}),pkg.context.user.at("horoscope",function(horoscope){PUBLIC.render(horoscope)})),PUBLIC},teardown:function(why,__static,__proto,__shared){}})});